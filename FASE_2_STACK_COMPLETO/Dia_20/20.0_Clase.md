

# ğŸ“š CLASE 20 â€“ IntroducciÃ³n al Backend con FastAPI

## ğŸ¯ OBJETIVO DEL DÃA

Aprender los fundamentos de FastAPI, crear un pequeÃ±o backend con dos rutas:

|MÃ©todo  |	Ruta    	  |  DescripciÃ³n														|
|------------------|------------------------------------------------------------------------|---|
|GET     |	/saludo	   |     Devuelve un saludo simple|
|POST	 |   /perfil	 |       Recibe datos JSON de un perfil|


## ğŸ§  Â¿QuÃ© es FastAPI?
```bash
FastAPI es un framework web en Python para crear APIs de forma rÃ¡pida y
moderna, usando lo mejor de Python 3.6+ como:
	â€¢	ğŸ¯ Tipado de datos (como TypeScript en JS)
	â€¢	âš¡ Muy rÃ¡pido (como Node.js, gracias a Starlette)
	â€¢	ğŸ“„ Genera documentaciÃ³n automÃ¡tica de tus endpoints
```

## ğŸ§© ANALOGÃA
```bash
Piensa en FastAPI como una centralita de recepciÃ³n:
	â€¢	Los clientes (navegador o frontend) llaman a diferentes extensiones: /saludo, /perfil, etc.
	â€¢	FastAPI recoge los datos, los procesa con funciones y devuelve una respuesta.
```
## Rutas
```bash
ğŸ“‚ tu_proyecto/
â”œâ”€â”€ env/                  # ğŸ§ª Entorno virtual (ignÃ³ralo)
â”œâ”€â”€ main.py               # âœ… AquÃ­ va tu app FastAPI
â”œâ”€â”€ requirements.txt      # ğŸ“¦ (opcional) para instalar dependencias
â””â”€â”€ README.md             # ğŸ“ DocumentaciÃ³n del proyecto (opcional)
```

## ğŸ› ï¸ PreparaciÃ³n del entorno
```bash
	1.	Crea una carpeta nueva para tu proyecto:

mkdir fastapi_intro && cd fastapi_intro

	2.	Crea entorno virtual y actÃ­valo:

python -m venv env
source env/bin/activate  # En Windows: env\Scripts\activate

	3.	Instala FastAPI y Uvicorn:

pip install fastapi uvicorn
```

--- 

# âœ… CÃ³mo vincular tu entorno virtual en VSCode sin volverte loco

## ğŸ§  Â¿Problema?
>Instalaste `fastapi` en tu entorno, pero en VSCode aparece subrayado en rojo (`from fastapi`) â†’ **VSCode no estÃ¡ usando tu entorno real.**


## ğŸ› ï¸ PASOS PARA VINCULAR TU ENTORNO CORRECTO

### 1. ğŸ“ AsegÃºrate de que el entorno estÃ¡ activado

```bash
source env/bin/activate  # o .venv/bin/activate
```

### 2. ğŸš€ Instala FastAPI en ese entorno (si no lo hiciste)
```bash
pip install fastapi uvicorn
```

### 3. ğŸ” Descubre la ruta del Python del entorno
```bash
which python
```

#### ğŸ” Te darÃ¡ algo como:
```bash
/Users/tu_usuario/mi_proyecto/env/bin/python
```

### 4. ğŸ§­ En VSCode â†’ selecciona ese entorno
```bash
1.	Cmd + Shift + P â†’ Python: Select Interpreter
2.	Selecciona â†’ Enter interpreter path
3.	Pega la ruta del paso anterior
4.	âœ… Confirmar
```

### 5. ğŸ”„ Recarga la ventana VSCode
```bash
Cmd + Shift + P â†’ Reload Window
```

### 6. ğŸ§ª Verifica
```bash
En terminal integrada de VSCode:
which python
âœ… Debe apuntar al entorno correcto (env/bin/python)
```

### ğŸ¯ Resultado final
```bash
â€¢	Sin errores en from fastapi
â€¢	Autocompletado funcionando
â€¢	FastAPI listo para correr:
```
```bash
uvicorn main:app --reload
```
---

## ğŸ” Â¿Conflicto con el puerto 8000?
```bash
FastAPI suele usar el puerto 8000. Si ya estÃ¡ ocupado, puedes comprobarlo y cerrarlo asÃ­:
```
## Ver quÃ© proceso estÃ¡ usando el puerto 8000
```bash
lsof -i :8000
```

#### Ejemplo de salida:
```bash
COMMAND   PID   USER
python3  12345  zokan
```
#### ğŸ‘‰ Paso siguiente: matar el proceso (PID = 12345 en este caso):
```bash
kill 12345        # ğŸ” Cierre normal
kill -9 12345     # ğŸ’£ Forzar si no responde
```
#### TambiÃ©n puedes ver todos los puertos de desarrollo activos con:
```bash
lsof -i :8*
```

## uvicorn es un servidor
```bash
 web ASGI (Asynchronous Server Gateway Interface) ligero y ultra rÃ¡pido, diseÃ±ado especialmente para correr aplicaciones
 asÃ­ncronas en Python, como las creadas con FastAPI.
```


## ğŸ§  Â¿Por quÃ© es importante uvicorn?
```bash
FastAPI no se ejecuta solo. Necesita un â€œmotorâ€ que reciba las peticiones HTTP y las redirija a tu app. Ese motor es uvicorn.
```
```bash
ğŸš€ Piensa en esto asÃ­:
	â€¢	ğŸ§  FastAPI: tu lÃ³gica y tus rutas (/saludo, /perfil, etc.)
	â€¢	ğŸ”Œ uvicorn: el mensajero entre internet y tu app
	â€¢	ğŸ› ï¸ Navegador â†’ uvicorn â†’ FastAPI â†’ Respuesta
```
## ğŸ§ª Explicacion del codigo
```py
# ğŸ“„ Importamos BaseModel de Pydantic
# Esto nos ayuda a validar y estructurar datos que llegan en el POST
# ğŸ” FastAPI y Pydantic trabajan juntos: uno gestiona las rutas, y el otro verifica que los datos que llegan tengan sentido.

# ğŸ§  Creamos una instancia de FastAPI â†’ Esto es nuestra app web
# ğŸ“ AquÃ­ empieza la centralita: es como levantar un telÃ©fono para que alguien pueda llamarte (ruta).

# Ruta GET: /saludo
# ğŸ“¡ GET = leer informaciÃ³n (como mirar un cartel).
'''
ğŸ” ExplicaciÃ³n:
	â€¢	@app.get("/saludo") â†’ Cada vez que alguien visita esa direcciÃ³n (/saludo), se ejecuta la funciÃ³n saludar.
	â€¢	return {...} â†’ Devuelve un diccionario convertido a JSON automÃ¡ticamente, que se puede ver desde el navegador o desde localhost:8000/docs.
'''

# ğŸ§¾ Definimos cÃ³mo debe lucir el objeto JSON que se envÃ­a en /perfil
'''
ğŸ§ª Esta clase sirve como molde: si llega algo diferente, FastAPI lanza un error automÃ¡ticamente. Â¡Sin que tÃº tengas que validar nada a mano!
'''

# ğŸ‘¤ Debe llegar un campo "nombre" tipo texto
# ğŸ”¢ Debe llegar un campo "edad" tipo nÃºmero

# ğŸ“¬ Ruta POST que recibe un perfil en formato JSON
'''
ğŸ” ExplicaciÃ³n:
	â€¢	@app.post("/perfil") â†’ Cuando alguien envÃ­a un JSON a esta ruta, se ejecuta esta funciÃ³n.
	â€¢	perfil: Perfil â†’ FastAPI verifica que lo que llega cumple el formato definido por la clase Perfil.
	â€¢	return â†’ Devolvemos un mensaje personalizado con los datos que nos han enviado.
'''
```


## ğŸ§ª CÃ“DIGO BASE â€“ main.py
```py

# ğŸ“„ Importamos BaseModel de Pydantic
# Esto nos ayuda a validar y estructurar datos que llegan en el POST
# ğŸ” FastAPI y Pydantic trabajan juntos: uno gestiona las rutas, y el otro verifica que los datos que llegan tengan sentido.
from fastapi import FastAPI
from pydantic import BaseModel

# ğŸ§  Creamos una instancia de FastAPI â†’ Esto es nuestra app web
# ğŸ“ AquÃ­ empieza la centralita: es como levantar un telÃ©fono para que alguien pueda llamarte (ruta).
app = FastAPI()

# Ruta GET: /saludo
# ğŸ“¡ GET = leer informaciÃ³n (como mirar un cartel).
'''
ğŸ” ExplicaciÃ³n:
	â€¢	@app.get("/saludo") â†’ Cada vez que alguien visita esa direcciÃ³n (/saludo), se ejecuta la funciÃ³n saludar.
	â€¢	return {...} â†’ Devuelve un diccionario convertido a JSON automÃ¡ticamente, que se puede ver desde el navegador o desde localhost:8000/docs.
'''
@app.get("/saludo")
def saludar():
    return {"mensaje": "Â¡Hola desde FastAPI!"}

# ğŸ§¾ Definimos cÃ³mo debe lucir el objeto JSON que se envÃ­a en /perfil
'''
ğŸ§ª Esta clase sirve como molde: si llega algo diferente, FastAPI lanza un error automÃ¡ticamente. Â¡Sin que tÃº tengas que validar nada a mano!
'''
class Perfil(BaseModel):
    nombre: str   # ğŸ‘¤ Debe llegar un campo "nombre" tipo texto
    edad: int     # ğŸ”¢ Debe llegar un campo "edad" tipo nÃºmero

# ğŸ“¬ Ruta POST que recibe un perfil en formato JSON
'''
ğŸ” ExplicaciÃ³n:
	â€¢	@app.post("/perfil") â†’ Cuando alguien envÃ­a un JSON a esta ruta, se ejecuta esta funciÃ³n.
	â€¢	perfil: Perfil â†’ FastAPI verifica que lo que llega cumple el formato definido por la clase Perfil.
	â€¢	return â†’ Devolvemos un mensaje personalizado con los datos que nos han enviado.
'''
@app.post("/perfil")
# Siempre se escribe asÃ­: def FUNCION (variable: Tipo)
# variable `perfil` debe seguir la estructura definida en la clase `Perfil`
def recibir_perfil(perfil: Perfil):
    return {
        "mensaje": f"Perfil recibido de {perfil.nombre}, edad {perfil.edad}"
    }

```

## ğŸ§ª Recapitulando visualmente

| Parte             | Â¿QuÃ© hace?                                                               |
|------------------|---------------------------------------------------------------------------|
| `from fastapi`   | Importa el motor principal del backend                                    |
| `from pydantic`  | Permite validar los datos que llegan                                      |
| `app = FastAPI()`| Crea tu servidor web                                                      |
| `@app.get(...)`  | Ruta para leer algo (GET)                                                 |
| `@app.post(...)` | Ruta para enviar algo (POST con JSON)                                     |
| `class Perfil...`| Define el formato que esperamos (nombre + edad)                           |
| `uvicorn`        | Es quien arranca el motor y escucha peticiones en `localhost:8000`        |
| `ğŸ“¡ POST`		   | enviar informaciÃ³n (como rellenar y mandar un formulario).				   |



## ğŸ”¹ http://localhost:8000
```bash
ğŸ‘‰ Es la raÃ­z de tu servidor FastAPI.
Cuando accedes ahÃ­, verÃ¡s un mensaje simple si tienes una ruta en /, o un error si no la has definido.
```
#### Ejemplo:
```py
@app.get("/")
def raiz():
    return {"mensaje": "Bienvenido a mi API"}
```
> Si no tienes una ruta / definida, verÃ¡s un error 404 al entrar.

## ğŸ”¹ http://localhost:8000/docs

#### Te permite:

ğŸ§ª Funciones de la documentaciÃ³n interactiva en FastAPI (`/docs`)

| ğŸ”§ FunciÃ³n.                      | Â¿Para quÃ© sirve?                                                             |
|----------------------------------|------------------------------------------------------------------------------|
| ğŸ“– Ver todas las rutas           | Muestra todas las rutas (`GET`, `POST`, etc.) con sus descripciones.         |
| ğŸ§ª Probar peticiones directamente| Permite enviar datos a la API sin usar Postman ni escribir cÃ³digo.           |
| ğŸ§  Ver el esquema de entrada     | Muestra quÃ© campos se requieren en un `POST` o cualquier entrada validada.   |
| ğŸ” Recibir la respuesta real     | Devuelve la respuesta real que generarÃ­a la API, como si fueras un frontend. |


> ğŸ‘‰ Es la documentaciÃ³n automÃ¡tica generada por FastAPI (usando Swagger UI).


## ğŸ¯ AnalogÃ­a rÃ¡pida:
```bash
URL	Rol en la app
localhost:8000	Tu casa (la entrada principal)
localhost:8000/docs	El mapa interactivo de tu casa
```


## â–¶ï¸ EJECUTAR EL SERVIDOR
```bash
# En la ruta donde se encuentra el servidor
uvicorn main:app --reload

	â€¢	Abre navegador en: http://localhost:8000
	â€¢	DocumentaciÃ³n automÃ¡tica: http://localhost:8000/docs
```

>ğŸ§­ Recuerda:
> Tu servidor no tiene una ruta /, solo estas dos:


## ğŸŒ Rutas bÃ¡sicas en FastAPI

| **MÃ©todo** | **Ruta**    | **Â¿QuÃ© hace?**                                  |
|------------|-------------|--------------------------------------------------|
| `GET`      | `/saludo`   | Devuelve un saludo simple.                      |
| `POST`     | `/perfil`   | Recibe datos tipo JSON (nombre + edad).         |


#### QuÃ© hacer ahora:
```bash
1. Entra en la ruta que sÃ­ existe:

Ve a:
http://localhost:8000/saludo

Y deberÃ­as ver:
```
```py
{
  "mensaje": "Â¡Hola desde FastAPI!"
}
```
```bash
2. Usa Swagger para probar el POST:
```
> Visita:
http://localhost:8000/docs

```bash
Y ahÃ­ verÃ¡s tu API documentada automÃ¡ticamente (Â¡FastAPI lo hace solo!). Desde esa interfaz puedes:
	â€¢	Ver la ruta GET /saludo y probarla.
	â€¢	Usar el botÃ³n â€œPOST /perfilâ€, hacer clic en â€œTry it outâ€, escribir un JSON como este:
```
```py
{
  "nombre": "Jaime",
  "edad": 30
}

# Y recibirÃ¡s una respuesta como:

{
  "mensaje": "Perfil recibido de Jaime, edad 30"
}
```

## ğŸ” LO QUE APRENDES
```bash
âœ… Crear servidor con FastAPI
âœ… Definir rutas GET y POST
âœ… Usar modelos con Pydantic
âœ… Recibir y validar JSON automÃ¡ticamente
âœ… Ver documentaciÃ³n Swagger automÃ¡tica
```

## ğŸ§ª RETO DEL DÃA (Resumen)
```bash
	1.	Crea el archivo main.py como arriba.
	2.	AÃ±ade una ruta GET que devuelva un saludo.
	3.	AÃ±ade una ruta POST que reciba un perfil JSON (nombre, edad).
	4.	Prueba desde /docs en el navegador.
```
